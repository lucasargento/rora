Problem Name: 14_Stock_Portfolio_Optimization

Mathematical Formulation:
\[
\begin{array}{rcl}
\textbf{Parameters:} & & \\
& N \in \mathbb{N} & \text{(number of different stocks)} \\
& Bought_i \ge 0,\quad BuyPrice_i > 0,\quad CurrentPrice_i > 0,\quad FuturePrice_i > 0,\quad i=1,\ldots,N, & \\
& TransactionRate \ge 0,\quad TaxRate \ge 0,\quad K \ge 0, & \\
& \Delta_i \;:=\; \max\{0,\; (CurrentPrice_i - BuyPrice_i)\},\quad i=1,\ldots,N. & \\[1ex]

\textbf{Decision Variables:} & & \\
& x_i \in [0,\,Bought_i],\quad i=1,\ldots,N, & \text{(shares of stock $i$ to sell; fractional amounts allowed)} \\[1ex]

\textbf{Auxiliary Expression:} & & \\
& R_i \;:=\; x_i \left[ CurrentPrice_i \left(1 - \frac{TransactionRate}{100}\right) - \frac{TaxRate}{100}\,\Delta_i \right],\quad i=1,\ldots,N, & \text{(net cash received from selling stock $i$)} \\[1ex]

\textbf{Objective Function:} & & \\
\text{maximize} \quad Z \;=\; & \displaystyle \sum_{i=1}^N \Big[(Bought_i - x_i)\, FuturePrice_i\Big] \;+\; \sum_{i=1}^N R_i. & \\[1ex]

\textbf{Subject to:} & & \\
& \displaystyle \sum_{i=1}^N R_i \;\ge\; K, & \text{(the net sale proceeds must raise at least \$K)} \\[1ex]
& 0 \;\le\; x_i \;\le\; Bought_i,\quad \forall\, i=1,\ldots,N. &
\end{array}
\]

Below is a brief explanation of each part:

1. Decision Variables:  
 • x₍ᵢ₎ is the (possibly fractional) number of shares of asset i that the investor elects to sell. Its domain is from 0 to the number initially held, Bought₍ᵢ₎.

2. Objective Function (Maximization):  
 • The first term, ∑₍ᵢ₌₁₎ᴺ (Bought₍ᵢ₎ – x₍ᵢ₎) FuturePrice₍ᵢ₎, represents the future value of the shares that remain in the portfolio.  
 • The second term, ∑₍ᵢ₌₁₎ᴺ R₍ᵢ₎, represents the net cash received from selling shares (i.e. after paying transaction costs and, for stocks with a capital gain, the capital gains tax).  
 • Thus the objective is to maximize the total expected portfolio value one year from now (the sum of the future value of unsold stocks and the cash generated from sales).

3. Constraints:  
 • The sales must raise at least K dollars after transaction costs and taxes.  
 • Additionally, the amount sold of each stock cannot exceed the number originally held.

This formulation is self-contained, reflects the full details of the problem without simplification, and is bounded and feasible under reasonable parameter values.

Execution Results:
SUCCESS:
Optimal solution found:
  Sell 42.9983 shares of stock 1
  Sell 0.0000 shares of stock 2
  Sell 80.0000 shares of stock 3
Optimal portfolio value next year: 15305.1123
Total net cash raised: 5000.0000


Expected Output:
Expected solution

: {'_objective': 10305.11226}
